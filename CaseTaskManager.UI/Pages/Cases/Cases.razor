@page "/cases"

<h3>All Cases</h3>

<button class="btn btn-primary mb-3" @onclick="AddNewCase">Add Case</button>

@if (allCases is null)
{
    <p><em>Loading...</em></p>
}
else if (!allCases.Any())
{
    <p>No cases found.</p>
}
else
{
    <div class="table-responsive">
        <table class="table table-hover table-sm align-middle table-fixed">
            <colgroup>
                <col style="width:64px" />      @* Id *@
                <col style="width:22%" />       @* Title *@
                <col />                         @* Description (flex) *@
                <col style="width:132px" />     @* Status *@
                <col style="width:140px" />     @* Created *@
                <col style="width:230px" />     @* Actions *@
            </colgroup>

            <thead class="table-light sticky-top">
                <tr>
                    <th style="width:64px">Id</th>
                    <th style="width:22%">Title</th>
                    <th>Description</th>
                    <th style="width:132px" class="text-center">Status</th>
                    <th style="width:140px">Created</th>
                    <!-- center the header -->
                    <th style="width:230px" class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var c in allCases)
                {
                    <tr>
                        <td class="text-muted">@c.Id</td>
                        <td class="fw-semibold">@c.Title</td>
                        <td class="text-truncate" title="@c.Description">@c.Description</td>
                        <td class="text-center">
                            <span class="badge bg-secondary-subtle text-body border">
                                @(!string.IsNullOrWhiteSpace(c.CurrentStatusName)
                                    ? c.CurrentStatusName
                                    : (c.CurrentStatusId.HasValue ? $"#{c.CurrentStatusId}" : "No status"))
                            </span>
                        </td>
                        <td>@c.CreatedAt.ToString("yyyy-MM-dd")</td>
                        <!-- keep the cells right-aligned -->
                        <td class="text-end">
                            <div class="btn-group btn-group-sm" role="group" aria-label="Actions">
                                <button class="btn btn-info" @onclick="@(()=> ViewDetails(c.Id))">Details</button>
                                <button class="btn btn-warning" @onclick="@(()=> EditCase(c.Id))">Edit</button>
                                <button class="btn btn-outline-danger" @onclick="@(()=> GoToDelete(c.Id))">Delete</button>
                            </div>
                        </td>
                    </tr>
                }
            </tbody>

        </table>
    </div>
}
